<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Abrechnungshelfer Medizin</title>
  <style>
    body { font-family: 'Segoe UI', Tahoma, Arial; margin:0; background:linear-gradient(135deg,#e0f7fa,#e3f2fd); min-height:100vh; display:flex; align-items:center; justify-content:center; }
    .card { background:#fff; width:min(620px,92vw); padding:24px; border-radius:16px; box-shadow:0 8px 30px rgba(0,0,0,.08); }
    h1 { margin:0 0 8px; color:#0f6ea6; }
    p { margin:0 0 16px; color:#333; }
    textarea, input, button { width:100%; box-sizing:border-box; font-size:16px; }
    textarea, input { padding:12px; border-radius:10px; border:1px solid #cfd8dc; background:#fafafa; }
    textarea { min-height:110px; resize:vertical; margin-bottom:12px; }
    input { margin:8px 0 12px; }
    button { background:#0f6ea6; color:#fff; border:none; padding:12px 16px; border-radius:10px; cursor:pointer; font-weight:600; }
    button:hover { background:#0d5c8b; }
    .out { margin-top:16px; white-space:pre-wrap; background:#f6f8fa; border:1px solid #e0e0e0; border-radius:10px; padding:12px; min-height:80px; }
    .row { display:grid; grid-template-columns: 1fr 180px; gap:10px; }
    @media (max-width:640px){ .row { grid-template-columns:1fr; } }
    .hint { font-size:13px; color:#607d8b; margin-top:-6px; margin-bottom:12px;}
  </style>
</head>
<body>
  <div class="card">
    <h1>Abrechnungshelfer Medizin</h1>
    <p>Bitte geben Sie <strong>Diagnose</strong>, <strong>Alter</strong>, <strong>Geschlecht</strong> und <strong>Versicherungsträger</strong> ein.</p>
    <div class="hint">Beispiel: Bluthochdruck, männlich, 62 Jahre, ÖGK</div>
    <textarea id="input"></textarea>
    <div class="row">
      <input type="password" id="access" placeholder="Zugangscode"/>
      <button id="go">Abrechnen</button>
    </div>
    <div id="response" class="out"></div>
  </div>

  <script>
    const API_URL = "/api/abrechnen"; // gleiche Domain wie Backend

    document.getElementById("go").addEventListener("click", send);

    async function send() {
      const prompt = document.getElementById("input").value.trim();
      const access = document.getElementById("access").value.trim();
      const out = document.getElementById("response");

      if (!prompt) { out.textContent = "Bitte Eingabe ausfüllen."; return; }
      if (!access) { out.textContent = "Bitte Zugangscode eingeben."; return; }

      out.textContent = "Bitte warten…";

      try {
        const res = await fetch(API_URL, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "X-Access-Code": access
          },
          body: JSON.stringify({ prompt })
        });

        const data = await res.json();
        if (!res.ok) {
          out.textContent = "Fehler: " + (data?.error || res.statusText);
          return;
        }
        out.textContent = data.output || "Keine Antwort erhalten.";
      } catch (e) {
        out.textContent = "Netzwerkfehler: " + e.message;
      }
    }
  </script>
</body>
</html>
